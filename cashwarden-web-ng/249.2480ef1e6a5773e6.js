"use strict";(self.webpackChunkcashwarden_web_ng=self.webpackChunkcashwarden_web_ng||[]).push([[249],{7249:(X,f,l)=>{l.r(f),l.d(f,{CategoryModule:()=>K});var h=l(4815),C=l(4465),z=l(8418),u=l(6152),d=l(8521),y=l(1243),Z=l(6672),T=l(9132),g=l(9094),n=l(4650),O=l(5156),M=l(9651),p=l(6895),s=l(433),c=l(1098),J=l(6704),x=l(6616),b=l(7044),A=l(1811),v=l(5635),m=l(8231),F=l(1102);function I(t,r){1&t&&(n.TgZ(0,"div",19),n._uU(1),n.ALo(2,"i18n"),n.qZA()),2&t&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"app.category.update"),""))}function N(t,r){1&t&&(n.TgZ(0,"div",19),n._uU(1),n.ALo(2,"i18n"),n.qZA()),2&t&&(n.xp6(1),n.Oqu(n.lcZ(2,1,"app.category.create")))}function q(t,r){if(1&t&&n._UZ(0,"nz-option",20),2&t){const e=r.$implicit;n.Q6J("nzLabel",e.label)("nzValue",e.value)}}function Y(t,r){if(1&t&&(n.TgZ(0,"label",21)(1,"span"),n._uU(2),n.qZA()()),2&t){const e=r.$implicit;n.Q6J("nzValue",e.value),n.xp6(2),n.Oqu(e.label)}}function S(t,r){if(1&t&&(n.TgZ(0,"label",22),n._UZ(1,"i",23),n.qZA()),2&t){const e=r.$implicit;n.Q6J("nzValue",e),n.xp6(1),n.MGl("nzIconfont","icon-",e,"")}}l(9553);let Q=(()=>{class t{constructor(e,o,i,a,_){this.modal=e,this.msg=o,this.http=i,this.cdr=a,this.i18n=_,this.url="/api/categories",this.record={},this.types=[],this.ledgers=[],this.form={name:"",keywords:[],transaction_type:"expense",sort:99,icon_name:"",default:!1,ledger_id:0},this.icons=[]}ngOnInit(){this.loadIcons(),this.record.id?this.form=this.record:this.record.ledger_id&&(this.form.ledger_id=this.record.ledger_id)}save(e){this.http.request(this.record.id?"put":"post",`${this.url}${this.record.id?`/${this.record.id}`:""}`,{body:e}).subscribe(a=>{a.code||(this.msg.success(this.i18n.fanyi("app.form.save-success")),this.modal.close(!0))})}loadIcons(){this.http.get("/api/site/icons").subscribe(e=>{this.icons=e,this.cdr.detectChanges()})}close(){this.modal.destroy()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(O.Lf),n.Y36(M.dD),n.Y36(g.lP),n.Y36(n.sBO),n.Y36(g.Oi))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-category-form"]],decls:36,vars:40,consts:[[1,"modal-header"],["class","modal-title",4,"ngIf"],["labelWidth","140","nz-form","","se-container","1.0",3,"ngSubmit"],["f","ngForm"],[3,"label"],["name","ledger_id","required","","nzShowSearch","",3,"ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["type","text","nz-input","","name","name","required","","maxlength","32",3,"ngModel","ngModelChange"],["nzButtonStyle","solid","name","type",3,"ngModel","ngModelChange"],["nz-radio-button","",3,"nzValue",4,"ngFor","ngForOf"],["nzMode","tags","name","keywords",3,"ngModel","ngModelChange"],["name","icon_name","required","",3,"ngModel","ngModelChange"],["nz-radio","",3,"nzValue",4,"ngFor","ngForOf"],["col","1",3,"label"],["name","default",3,"ngModel","ngModelChange"],["type","number","nz-input","","name","sort","required","",3,"ngModel","ngModelChange"],["col","1"],["nz-button","","type","button",3,"click"],["nz-button","","nzType","primary",3,"disabled"],[1,"modal-title"],[3,"nzLabel","nzValue"],["nz-radio-button","",3,"nzValue"],["nz-radio","",3,"nzValue"],["nz-icon","",1,"icon-md",3,"nzIconfont"]],template:function(e,o){if(1&e&&(n.TgZ(0,"div",0),n.YNc(1,I,3,3,"div",1),n.YNc(2,N,3,3,"div",1),n.qZA(),n.TgZ(3,"form",2,3),n.NdJ("ngSubmit",function(){return o.save(o.form)}),n.TgZ(5,"se",4),n.ALo(6,"i18n"),n.TgZ(7,"nz-select",5),n.NdJ("ngModelChange",function(a){return o.form.ledger_id=a}),n.YNc(8,q,1,2,"nz-option",6),n.qZA()(),n.TgZ(9,"se",4),n.ALo(10,"i18n"),n.TgZ(11,"input",7),n.NdJ("ngModelChange",function(a){return o.form.name=a}),n.qZA()(),n.TgZ(12,"se",4),n.ALo(13,"i18n"),n.TgZ(14,"nz-radio-group",8),n.NdJ("ngModelChange",function(a){return o.form.transaction_type=a}),n.YNc(15,Y,3,2,"label",9),n.qZA()(),n.TgZ(16,"se",4),n.ALo(17,"i18n"),n.TgZ(18,"nz-select",10),n.NdJ("ngModelChange",function(a){return o.form.keywords=a}),n.qZA()(),n.TgZ(19,"se",4),n.ALo(20,"i18n"),n.TgZ(21,"nz-radio-group",11),n.NdJ("ngModelChange",function(a){return o.form.icon_name=a}),n.YNc(22,S,2,2,"label",12),n.qZA()(),n.TgZ(23,"se",13),n.ALo(24,"i18n"),n.TgZ(25,"nz-switch",14),n.NdJ("ngModelChange",function(a){return o.form.default=a}),n.qZA()(),n.TgZ(26,"se",4),n.ALo(27,"i18n"),n.TgZ(28,"input",15),n.NdJ("ngModelChange",function(a){return o.form.sort=a}),n.qZA()(),n.TgZ(29,"se",16)(30,"button",17),n.NdJ("click",function(){return o.close()}),n._uU(31),n.ALo(32,"i18n"),n.qZA(),n.TgZ(33,"button",18),n._uU(34),n.ALo(35,"i18n"),n.qZA()()()),2&e){const i=n.MAs(4);n.xp6(1),n.Q6J("ngIf",o.record.id),n.xp6(1),n.Q6J("ngIf",!o.record.id),n.xp6(3),n.Q6J("label",n.lcZ(6,22,"app.category.ledger")),n.xp6(2),n.Q6J("ngModel",o.form.ledger_id),n.xp6(1),n.Q6J("ngForOf",o.ledgers),n.xp6(1),n.Q6J("label",n.lcZ(10,24,"app.category.name")),n.xp6(2),n.Q6J("ngModel",o.form.name),n.xp6(1),n.Q6J("label",n.lcZ(13,26,"app.category.transaction_type")),n.xp6(2),n.Q6J("ngModel",o.form.transaction_type),n.xp6(1),n.Q6J("ngForOf",o.types),n.xp6(1),n.Q6J("label",n.lcZ(17,28,"app.category.keywords")),n.xp6(2),n.Q6J("ngModel",o.form.keywords),n.xp6(1),n.Q6J("label",n.lcZ(20,30,"app.category.icon")),n.xp6(2),n.Q6J("ngModel",o.form.icon_name),n.xp6(1),n.Q6J("ngForOf",o.icons),n.xp6(1),n.Q6J("label",n.lcZ(24,32,"app.category.default")),n.xp6(2),n.Q6J("ngModel",o.form.default),n.xp6(1),n.Q6J("label",n.lcZ(27,34,"app.category.sort")),n.xp6(2),n.Q6J("ngModel",o.form.sort),n.xp6(3),n.Oqu(n.lcZ(32,36,"app.form.close")),n.xp6(2),n.Q6J("disabled",i.invalid),n.xp6(1),n.Oqu(n.lcZ(35,38,"app.form.save"))}},dependencies:[p.sg,p.O5,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.Q7,s.nD,s.On,s.F,c.nV,c.d_,J.Lr,x.ix,b.w,A.dQ,v.Zp,m.Ip,m.Vq,F.Ls,d.Of,d.Bq,d.Dg,y.i,g.Ck],encapsulation:2}),t})();var V=l(1971),$=l(6497);function U(t,r){if(1&t&&n._UZ(0,"nz-option",14),2&t){const e=r.$implicit;n.Q6J("nzLabel",e.label)("nzValue",e.value)}}function P(t,r){if(1&t&&n._UZ(0,"nz-option",14),2&t){const e=r.$implicit;n.Q6J("nzLabel",e.label)("nzValue",e.value)}}function w(t,r){1&t&&(n.TgZ(0,"nz-tag",22),n._uU(1,"Default"),n.qZA())}function B(t,r){if(1&t&&(n._uU(0),n.YNc(1,w,2,0,"nz-tag",21)),2&t){const e=n.oxw().$implicit;n.hij(" ",e.transaction_type," "),n.xp6(1),n.Q6J("ngIf",e.default)}}function D(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"i",23),n.NdJ("click",function(){n.CHM(e);const i=n.oxw().$implicit,a=n.oxw();return n.KtG(a.form(i))}),n.qZA()}if(2&t){const e=n.oxw().$implicit;n.MGl("nzIconfont","icon-",e.icon_name,"")}}function G(t,r){if(1&t&&(n.TgZ(0,"nz-tag",24),n._uU(1),n.qZA()),2&t){const e=r.$implicit;n.xp6(1),n.Oqu(e)}}function H(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"span",25)(1,"i",26),n.NdJ("click",function(){n.CHM(e);const i=n.oxw().$implicit,a=n.oxw();return n.KtG(a.form(i))}),n.qZA()(),n.TgZ(2,"span",25)(3,"i",27),n.NdJ("nzOnConfirm",function(){n.CHM(e);const i=n.oxw().$implicit,a=n.oxw();return n.KtG(a.delete(i))}),n.ALo(4,"i18n"),n.qZA()()}2&t&&(n.xp6(3),n.Q6J("nz-popconfirm",n.lcZ(4,1,"app.category.confirm.delete")))}function W(t,r){if(1&t&&(n.TgZ(0,"g2-card",15),n.YNc(1,B,2,2,"ng-template",null,16,n.W1O),n.YNc(3,D,1,1,"ng-template",null,17,n.W1O),n.TgZ(5,"trend",18),n.YNc(6,G,2,1,"nz-tag",19),n.qZA(),n.YNc(7,H,5,3,"ng-template",null,20,n.W1O),n.qZA()),2&t){const e=r.$implicit,o=n.MAs(2),i=n.MAs(4),a=n.MAs(8);n.MGl("total","<span class='text-xl'>",e.name,"</span>"),n.Q6J("title",o)("bordered",!0)("avatar",i)("action",a),n.xp6(6),n.Q6J("ngForOf",e.keywords)}}const j=function(){return{gutter:24,lg:8,md:12,sm:24,xs:24}};const R=[{path:"index",component:(()=>{class t{constructor(e,o,i,a,_){this.http=e,this.msg=o,this.modal=i,this.cdr=a,this.i18n=_,this.url="/api/categories",this.q={all:1,ledger_id:"",name:"",transaction_type:""},this.ledgers=[],this.types=[],this.loading=!1,this.list=[]}ngOnInit(){this.getLedgers(),this.getTypes()}index(){this.loading=!0,this.http.get(this.url,(0,z.HO)(this.q)).subscribe(e=>{this.list=e,this.loading=!1,this.cdr.detectChanges()})}getLedgers(){this.http.get("/api/ledgers?all=1").subscribe(e=>{this.q.ledger_id=e[0].id,this.index(),this.ledgers=e.map(o=>({label:o.name,value:o.id}))})}reset(){this.q.transaction_type="",this.q.name="",this.index()}form(e={}){e.id||(e.ledger_id=this.q.ledger_id),this.modal.create(Q,{record:e,types:this.types,ledgers:this.ledgers},{size:"md"}).subscribe(o=>{this.index(),this.cdr.detectChanges()})}delete(e){this.http.delete(`${this.url}/${e.id}`).subscribe(o=>{o.code||this.msg.success(this.i18n.fanyi("app.delete.success")),this.index()})}getTypes(){this.http.get(`${this.url}/types`).subscribe(e=>{this.types=e})}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(g.lP),n.Y36(M.dD),n.Y36(g.Te),n.Y36(n.sBO),n.Y36(g.Oi))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-category-index"]],decls:32,vars:41,consts:[[1,"pt-md"],["nz-form","","se-container","1.0","size","default","gutter","24",3,"labelWidth","ngSubmit"],["f","ngForm"],["col","4",3,"label"],["name","ledger_id","nzShowSearch","",3,"ngModel","nzPlaceHolder","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-input","","name","name",3,"ngModel","placeholder","ngModelChange"],["name","transaction_type","nzShowSearch","","nzAllowClear","",3,"ngModel","nzPlaceHolder","ngModelChange"],["nz-button","","type","submit",3,"nzType","nzLoading"],["nz-button","","type","button",1,"mx-sm",3,"click"],["nz-button","",3,"nzType","click"],["nz-icon","","nzType","plus"],[3,"nzDataSource","nzLoading","nzRenderItem","nzGrid"],["item",""],[3,"nzLabel","nzValue"],[3,"title","bordered","total","avatar","action"],["title",""],["avatar",""],[2,"margin","0 0 0 8px"],["class","text-grey",4,"ngFor","ngForOf"],["action",""],["nzColor","success",4,"ngIf"],["nzColor","success"],["nz-icon","",1,"icon-md",3,"nzIconfont","click"],[1,"text-grey"],[1,"pl-sm"],["nz-icon","","nzType","edit",3,"click"],["nz-icon","","nzType","delete","nzPopconfirmPlacement","bottom",3,"nz-popconfirm","nzOnConfirm"]],template:function(e,o){if(1&e&&(n.TgZ(0,"div",0)(1,"nz-card")(2,"form",1,2),n.NdJ("ngSubmit",function(){return o.index()}),n.TgZ(4,"se",3),n.ALo(5,"i18n"),n.TgZ(6,"nz-select",4),n.NdJ("ngModelChange",function(a){return o.q.ledger_id=a}),n.ALo(7,"i18n"),n.YNc(8,U,1,2,"nz-option",5),n.qZA()(),n.TgZ(9,"se",3),n.ALo(10,"i18n"),n.TgZ(11,"input",6),n.NdJ("ngModelChange",function(a){return o.q.name=a}),n.ALo(12,"i18n"),n.qZA()(),n.TgZ(13,"se",3),n.ALo(14,"i18n"),n.TgZ(15,"nz-select",7),n.NdJ("ngModelChange",function(a){return o.q.transaction_type=a}),n.ALo(16,"i18n"),n.YNc(17,P,1,2,"nz-option",5),n.qZA()(),n.TgZ(18,"button",8),n._uU(19),n.ALo(20,"i18n"),n.qZA(),n.TgZ(21,"button",9),n.NdJ("click",function(){return o.reset()}),n._uU(22),n.ALo(23,"i18n"),n.qZA()(),n.TgZ(24,"button",10),n.NdJ("click",function(){return o.form()}),n._UZ(25,"i",11),n.TgZ(26,"span"),n._uU(27),n.ALo(28,"i18n"),n.qZA()()(),n.TgZ(29,"nz-list",12),n.YNc(30,W,9,6,"ng-template",null,13,n.W1O),n.qZA()()),2&e){const i=n.MAs(31);n.xp6(2),n.Q6J("labelWidth",null),n.xp6(2),n.Q6J("label",n.lcZ(5,22,"app.category.ledger")),n.xp6(2),n.Q6J("ngModel",o.q.ledger_id)("nzPlaceHolder",n.lcZ(7,24,"app.category.ledger")),n.xp6(2),n.Q6J("ngForOf",o.ledgers),n.xp6(1),n.Q6J("label",n.lcZ(10,26,"app.category.name")),n.xp6(2),n.Q6J("ngModel",o.q.name)("placeholder",n.lcZ(12,28,"app.category.name")),n.xp6(2),n.Q6J("label",n.lcZ(14,30,"app.category.transaction_type")),n.xp6(2),n.Q6J("ngModel",o.q.transaction_type)("nzPlaceHolder",n.lcZ(16,32,"app.category.transaction_type")),n.xp6(2),n.Q6J("ngForOf",o.types),n.xp6(1),n.Q6J("nzType","primary")("nzLoading",o.loading),n.xp6(1),n.Oqu(n.lcZ(20,34,"app.form.search")),n.xp6(3),n.Oqu(n.lcZ(23,36,"app.form.reset")),n.xp6(2),n.Q6J("nzType","primary"),n.xp6(3),n.Oqu(n.lcZ(28,38,"app.form.create")),n.xp6(2),n.Q6J("nzDataSource",o.list)("nzLoading",o.loading)("nzRenderItem",i)("nzGrid",n.DdM(40,j))}},dependencies:[p.sg,p.O5,s._Y,s.Fj,s.JJ,s.JL,s.On,s.F,c.nV,c.d_,J.Lr,x.ix,b.w,A.dQ,v.Zp,m.Ip,m.Vq,V.bd,$.JW,F.Ls,u.n_,u.fl,h.n,Z.j,C._,g.Ck],encapsulation:2}),t})()}];let E=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[T.Bz.forChild(R),T.Bz]}),t})(),K=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[z.m8,E,u.Ph,h.T,Z.X,C.J,d.aF,y.m]}),t})()}}]);