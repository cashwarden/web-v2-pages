"use strict";(self.webpackChunkcashwarden_web_ng=self.webpackChunkcashwarden_web_ng||[]).push([[978],{4978:(he,_,i)=>{i.r(_),i.d(_,{CalendarModule:()=>ce});var J=i(8418),v=i(48),M=i(445),s=i(6895),e=i(4650),d=i(433),C=i(834),p=i(4896),c=i(8521),z=i(8231),h=i(4392),I=i(655),D=i(7579),Y=i(3085),w=i(3187);function O(t,o){if(1&t&&e._UZ(0,"nz-option",7),2&t){const n=o.$implicit;e.Q6J("nzLabel",n.label)("nzValue",n.value)}}function b(t,o){if(1&t&&e._UZ(0,"nz-option",7),2&t){const n=o.$implicit;e.Q6J("nzLabel",n.label)("nzValue",n.value)}}function Q(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"nz-select",8),e.NdJ("ngModelChange",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.monthChange.emit(r))}),e.YNc(1,b,1,2,"nz-option",2),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("nzSize",n.size)("nzDropdownMatchSelectWidth",!1)("ngModel",n.activeMonth),e.xp6(1),e.Q6J("ngForOf",n.months)}}function H(t,o){1&t&&e.GkF(0)}function R(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"date-table",6),e.NdJ("valueChange",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.onDateSelect(r))}),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("prefixCls",n.prefixCls)("value",n.activeDate)("activeDate",n.activeDate)("cellRender",n.dateCell)("fullCellRender",n.dateFullCell)("disabledDate",n.nzDisabledDate)}}function U(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"month-table",7),e.NdJ("valueChange",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.onDateSelect(r))}),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("prefixCls",n.prefixCls)("value",n.activeDate)("activeDate",n.activeDate)("cellRender",n.monthCell)("fullCellRender",n.monthFullCell)}}let y=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=e.lG2({type:t,selectors:[["","nzDateCell",""]],exportAs:["nzDateCell"]}),t})(),T=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=e.lG2({type:t,selectors:[["","nzMonthCell",""]],exportAs:["nzMonthCell"]}),t})(),V=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=e.lG2({type:t,selectors:[["","nzDateFullCell",""]],exportAs:["nzDateFullCell"]}),t})(),B=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=e.lG2({type:t,selectors:[["","nzMonthFullCell",""]],exportAs:["nzMonthFullCell"]}),t})(),G=(()=>{class t{constructor(n,a){this.i18n=n,this.dateHelper=a,this.mode="month",this.fullscreen=!0,this.activeDate=new h.Yp,this.modeChange=new e.vpe,this.yearChange=new e.vpe,this.monthChange=new e.vpe,this.yearOffset=10,this.yearTotal=20,this.years=[],this.months=[]}get activeYear(){return this.activeDate.getYear()}get activeMonth(){return this.activeDate.getMonth()}get size(){return this.fullscreen?"default":"small"}get yearTypeText(){return this.i18n.getLocale().Calendar.lang.year}get monthTypeText(){return this.i18n.getLocale().Calendar.lang.month}ngOnInit(){this.setUpYears(),this.setUpMonths()}updateYear(n){this.yearChange.emit(n),this.setUpYears(n)}setUpYears(n){const a=(n||this.activeYear)-this.yearOffset,r=a+this.yearTotal;this.years=[];for(let l=a;l<r;l++)this.years.push({label:`${l}`,value:l})}setUpMonths(){this.months=[];for(let n=0;n<12;n++){const a=this.activeDate.setMonth(n),r=this.dateHelper.format(a.nativeDate,"MMM");this.months.push({label:r,value:n})}}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(p.wi),e.Y36(p.mx))},t.\u0275cmp=e.Xpm({type:t,selectors:[["nz-calendar-header"]],hostAttrs:[1,"ant-fullcalendar-header"],hostVars:2,hostBindings:function(n,a){2&n&&e.Udp("display","block")},inputs:{mode:"mode",fullscreen:"fullscreen",activeDate:"activeDate"},outputs:{modeChange:"modeChange",yearChange:"yearChange",monthChange:"monthChange"},exportAs:["nzCalendarHeader"],decls:9,vars:9,consts:[[1,"ant-picker-calendar-header"],[1,"ant-picker-calendar-year-select",3,"nzSize","nzDropdownMatchSelectWidth","ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["class","ant-picker-calendar-month-select",3,"nzSize","nzDropdownMatchSelectWidth","ngModel","ngModelChange",4,"ngIf"],[1,"ant-picker-calendar-mode-switch",3,"ngModel","nzSize","ngModelChange"],["nz-radio-button","","nzValue","month"],["nz-radio-button","","nzValue","year"],[3,"nzLabel","nzValue"],[1,"ant-picker-calendar-month-select",3,"nzSize","nzDropdownMatchSelectWidth","ngModel","ngModelChange"]],template:function(n,a){1&n&&(e.TgZ(0,"div",0)(1,"nz-select",1),e.NdJ("ngModelChange",function(l){return a.updateYear(l)}),e.YNc(2,O,1,2,"nz-option",2),e.qZA(),e.YNc(3,Q,2,4,"nz-select",3),e.TgZ(4,"nz-radio-group",4),e.NdJ("ngModelChange",function(l){return a.mode=l})("ngModelChange",function(l){return a.modeChange.emit(l)}),e.TgZ(5,"label",5),e._uU(6),e.qZA(),e.TgZ(7,"label",6),e._uU(8),e.qZA()()()),2&n&&(e.xp6(1),e.Q6J("nzSize",a.size)("nzDropdownMatchSelectWidth",!1)("ngModel",a.activeYear),e.xp6(1),e.Q6J("ngForOf",a.years),e.xp6(1),e.Q6J("ngIf","month"===a.mode),e.xp6(1),e.Q6J("ngModel",a.mode)("nzSize",a.size),e.xp6(2),e.Oqu(a.monthTypeText),e.xp6(2),e.Oqu(a.yearTypeText))},dependencies:[s.sg,s.O5,d.JJ,d.On,c.Of,c.Bq,c.Dg,z.Ip,z.Vq],encapsulation:2,changeDetection:0}),t})(),L=(()=>{class t{constructor(n,a){this.cdr=n,this.directionality=a,this.activeDate=new h.Yp,this.prefixCls="ant-picker-calendar",this.destroy$=new D.x,this.dir="ltr",this.onChangeFn=()=>{},this.onTouchFn=()=>{},this.nzMode="month",this.nzModeChange=new e.vpe,this.nzPanelChange=new e.vpe,this.nzSelectChange=new e.vpe,this.nzValueChange=new e.vpe,this.nzFullscreen=!0}get dateCell(){return this.nzDateCell||this.nzDateCellChild}get dateFullCell(){return this.nzDateFullCell||this.nzDateFullCellChild}get monthCell(){return this.nzMonthCell||this.nzMonthCellChild}get monthFullCell(){return this.nzMonthFullCell||this.nzMonthFullCellChild}ngOnInit(){this.dir=this.directionality.value,this.directionality.change?.pipe((0,Y.R)(this.destroy$)).subscribe(()=>{this.dir=this.directionality.value})}onModeChange(n){this.nzModeChange.emit(n),this.nzPanelChange.emit({date:this.activeDate.nativeDate,mode:n})}onYearSelect(n){const a=this.activeDate.setYear(n);this.updateDate(a)}onMonthSelect(n){const a=this.activeDate.setMonth(n);this.updateDate(a)}onDateSelect(n){this.updateDate(n)}writeValue(n){this.updateDate(new h.Yp(n),!1),this.cdr.markForCheck()}registerOnChange(n){this.onChangeFn=n}registerOnTouched(n){this.onTouchFn=n}updateDate(n,a=!0){this.activeDate=n,a&&(this.onChangeFn(n.nativeDate),this.onTouchFn(),this.nzSelectChange.emit(n.nativeDate),this.nzValueChange.emit(n.nativeDate))}ngOnChanges(n){n.nzValue&&this.updateDate(new h.Yp(this.nzValue),!1)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(e.sBO),e.Y36(M.Is,8))},t.\u0275cmp=e.Xpm({type:t,selectors:[["nz-calendar"]],contentQueries:function(n,a,r){if(1&n&&(e.Suo(r,y,5,e.Rgc),e.Suo(r,V,5,e.Rgc),e.Suo(r,T,5,e.Rgc),e.Suo(r,B,5,e.Rgc)),2&n){let l;e.iGM(l=e.CRH())&&(a.nzDateCellChild=l.first),e.iGM(l=e.CRH())&&(a.nzDateFullCellChild=l.first),e.iGM(l=e.CRH())&&(a.nzMonthCellChild=l.first),e.iGM(l=e.CRH())&&(a.nzMonthFullCellChild=l.first)}},hostAttrs:[1,"ant-picker-calendar"],hostVars:6,hostBindings:function(n,a){2&n&&e.ekj("ant-picker-calendar-full",a.nzFullscreen)("ant-picker-calendar-mini",!a.nzFullscreen)("ant-picker-calendar-rtl","rtl"===a.dir)},inputs:{nzMode:"nzMode",nzValue:"nzValue",nzDisabledDate:"nzDisabledDate",nzDateCell:"nzDateCell",nzDateFullCell:"nzDateFullCell",nzMonthCell:"nzMonthCell",nzMonthFullCell:"nzMonthFullCell",nzFullscreen:"nzFullscreen"},outputs:{nzModeChange:"nzModeChange",nzPanelChange:"nzPanelChange",nzSelectChange:"nzSelectChange",nzValueChange:"nzValueChange"},exportAs:["nzCalendar"],features:[e._Bn([{provide:d.JU,useExisting:(0,e.Gpc)(()=>t),multi:!0}]),e.TTD],decls:9,vars:9,consts:[[3,"fullscreen","activeDate","mode","modeChange","yearChange","monthChange"],[1,"ant-picker-panel"],[1,"ant-picker-body"],[4,"ngIf","ngIfThen","ngIfElse"],["monthModeTable",""],["yearModeTable",""],[3,"prefixCls","value","activeDate","cellRender","fullCellRender","disabledDate","valueChange"],[3,"prefixCls","value","activeDate","cellRender","fullCellRender","valueChange"]],template:function(n,a){if(1&n&&(e.TgZ(0,"nz-calendar-header",0),e.NdJ("modeChange",function(l){return a.nzMode=l})("modeChange",function(l){return a.onModeChange(l)})("yearChange",function(l){return a.onYearSelect(l)})("monthChange",function(l){return a.onMonthSelect(l)}),e.qZA(),e.TgZ(1,"div",1)(2,"div")(3,"div",2),e.YNc(4,H,1,0,"ng-container",3),e.qZA()()(),e.YNc(5,R,1,6,"ng-template",null,4,e.W1O),e.YNc(7,U,1,5,"ng-template",null,5,e.W1O)),2&n){const r=e.MAs(6),l=e.MAs(8);e.Q6J("fullscreen",a.nzFullscreen)("activeDate",a.activeDate)("mode",a.nzMode),e.xp6(2),e.Gre("ant-picker-","month"===a.nzMode?"date":"month","-panel"),e.xp6(2),e.Q6J("ngIf","month"===a.nzMode)("ngIfThen",r)("ngIfElse",l)}},dependencies:[s.O5,C.te,C.Ah,G],encapsulation:2,changeDetection:0}),(0,I.gn)([(0,w.yF)()],t.prototype,"nzFullscreen",void 0),t})(),j=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[M.vT,s.ez,d.u5,p.YI,c.aF,z.LV,C.rT]}),t})();var x=i(6152),N=i(8800),F=i(9132),u=i(9094),g=i(9903),P=i(4004),$=i(8074),q=i(9651),E=i(9959),S=i(3679),W=i(6616),K=i(7044),X=i(1811),k=i(1971),ee=i(3402);function ne(t,o){if(1&t&&(e.TgZ(0,"div")(1,"li")(2,"nz-badge",14),e._uU(3),e.qZA(),e.TgZ(4,"nz-badge",15),e._uU(5),e.qZA()()()),2&t){const n=o.ngIf;e.xp6(3),e.Oqu((null==n?null:n.inflow)||0),e.xp6(2),e.hij("- ",(null==n?null:n.outflow)||0,"")}}function te(t,o){if(1&t&&(e.TgZ(0,"ul",13),e.YNc(1,ne,6,2,"div",7),e.qZA()),2&t){const n=o.$implicit,a=e.oxw(2);e.xp6(1),e.Q6J("ngIf",a.getDateData(n))}}function ae(t,o){if(1&t&&(e.TgZ(0,"div",17)(1,"section"),e._uU(2),e.qZA(),e.TgZ(3,"span"),e._uU(4,"Backlog number"),e.qZA()()),2&t){const n=o.ngIf;e.xp6(2),e.Oqu(n)}}function le(t,o){if(1&t&&(e.ynx(0),e.YNc(1,ae,5,1,"div",16),e.BQk()),2&t){const n=o.$implicit,a=e.oxw(2);e.xp6(1),e.Q6J("ngIf",a.getMonthData(n))}}function oe(t,o){if(1&t){const n=e.EpF();e.ynx(0),e.TgZ(1,"nz-calendar",10),e.NdJ("nzSelectChange",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.selectChange(r))})("nzPanelChange",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.panelChange(r))}),e.YNc(2,te,2,1,"ul",11),e.YNc(3,le,2,1,"ng-container",12),e.qZA(),e.BQk()}}function re(t,o){if(1&t&&(e._uU(0),e.ALo(1,"i18n"),e.TgZ(2,"small",18)(3,"nz-badge",14)(4,"span",19),e._uU(5),e.qZA()(),e.TgZ(6,"nz-badge",15)(7,"span",19),e._uU(8),e.qZA()()()),2&t){const n=e.oxw();e.hij(" ",e.lcZ(1,3,"app.record")," "),e.xp6(5),e.hij(" ",(null==n.current?null:n.current.inflow_desc)||0," "),e.xp6(3),e.hij(" -",(null==n.current?null:n.current.outflow_desc)||0," ")}}i(9553);const ie=function(){return{xs:6,sm:16,md:24,lg:32}};const se=[{path:"index",component:(()=>{class t{constructor(n,a,r,l,m){this.http=n,this.msg=a,this.modal=r,this.cdr=l,this.i18n=m,this.resetSubjectValue=new D.x,this.q={},this.rq={page:1,page_size:100,expand:"transaction,account,category,ledger"},this.data={},this.loading=!0,this.date=new Date,this.mode="month",this.searchSchema={properties:{ledger_id:{type:"integer",title:this.i18n.fanyi("app.ledger_id"),default:"",ui:{widget:"select",autosize:!0,allowClear:!0,asyncData:()=>this.http.get("/api/ledgers?all=1").pipe((0,P.U)(f=>f.map(A=>({value:A.id,label:A.name}))))}}}}}ngOnInit(){this.index()}index(){this.selectChange(this.date)}getData(){this.http.get("/api/analysis/calendar",this.q).subscribe(n=>{this.data=n,this.current=n.filter(a=>a.date===g.lI.format(this.date,"yyyy-MM-dd"))[0],this.loading=!1,this.cdr.detectChanges()})}getDateData(n){const a=g.lI.format(n,"yyyy-MM-dd");return this.data.filter(r=>r.date===a).length>0?this.data.filter(r=>r.date===a)[0]:null}getMonthData(n){return null}panelChange(n){console.log(`Current value: ${n.date}`),console.log(`Current mode: ${n.mode}`)}getDateForSelect(n,a){const r=new Date(n.getTime()-24*a*60*60*1e3),l=new Date(n.getTime()+24*a*60*60*1e3);return`${g.lI.format(r,"yyyy-MM-dd")}~${g.lI.format(l,"yyyy-MM-dd")}`}selectChange(n){this.date=n,this.rq.date=this.getDateForSelect(n,0),this.q.date=this.getDateForSelect(n,41),this.getData(),this.resetSubjectValue.next(this.rq)}form(n={}){n.transaction=n.transaction||{date:this.date},this.modal.create($.y,{record:n.transaction},{size:"md"}).subscribe(()=>{this.q.page=1,this.resetSubjectValue.next(this.q),this.cdr.detectChanges()})}submit(n){this.q.ledger_id=n.ledger_id?n.ledger_id:"",this.rq.ledger_id=n.ledger_id?n.ledger_id:"",this.index()}reset(){this.q.ledger_id="",this.rq.ledger_id="",this.index()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(u.lP),e.Y36(q.dD),e.Y36(u.Te),e.Y36(e.sBO),e.Y36(u.Oi))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-calendar-index"]],decls:20,vars:27,consts:[[1,"pt-md"],["nz-row","",3,"nzGutter"],["nz-col",""],["mode","search",3,"schema","formSubmit","formReset"],["nz-button","","nzType","primary",3,"click"],["nz-col","",3,"nzXs","nzSm","nzMd","nzLg"],[1,"mb-0",3,"nzLoading","nzBordered","nzTitle"],[4,"ngIf"],["nzTitle",""],[3,"q","resetSubject","showActions"],[3,"nzSelectChange","nzPanelChange"],["class","events",4,"nzDateCell"],[4,"nzMonthCell"],[1,"events"],["nzStatus","success"],["nzStatus","error"],["class","notes-month",4,"ngIf"],[1,"notes-month"],[1,"text-xs","extra"],["nz-typography","","nzType","secondary"]],template:function(n,a){if(1&n&&(e.TgZ(0,"div",0)(1,"nz-card")(2,"div",1)(3,"div",2)(4,"sf",3),e.NdJ("formSubmit",function(l){return a.submit(l)})("formReset",function(){return a.reset()}),e.qZA()(),e.TgZ(5,"div",2)(6,"button",4),e.NdJ("click",function(){return a.form()}),e._uU(7),e.ALo(8,"i18n"),e.qZA()()()()(),e.TgZ(9,"div",1)(10,"div",5)(11,"nz-card",6),e.ALo(12,"i18n"),e.YNc(13,oe,4,0,"ng-container",7),e.qZA()(),e.TgZ(14,"div",5)(15,"nz-card",6),e.YNc(16,re,9,5,"ng-template",null,8,e.W1O),e.TgZ(18,"nz-list"),e._UZ(19,"record-table",9),e.qZA()()()()),2&n){const r=e.MAs(17);e.xp6(2),e.Q6J("nzGutter",e.DdM(26,ie)),e.xp6(2),e.Q6J("schema",a.searchSchema),e.xp6(3),e.Oqu(e.lcZ(8,22,"app.form.create")),e.xp6(2),e.Q6J("nzGutter",24),e.xp6(1),e.Q6J("nzXs",24)("nzSm",24)("nzMd",24)("nzLg",14),e.xp6(1),e.Q6J("nzLoading",a.loading)("nzBordered",!1)("nzTitle",e.lcZ(12,24,"app.calendar")),e.xp6(2),e.Q6J("ngIf",!a.loading),e.xp6(1),e.Q6J("nzXs",24)("nzSm",24)("nzMd",24)("nzLg",10),e.xp6(1),e.Q6J("nzLoading",a.loading)("nzBordered",!1)("nzTitle",r),e.xp6(4),e.Q6J("q",a.rq)("resetSubject",a.resetSubjectValue)("showActions",!1)}},dependencies:[s.O5,E.kJ,S.t3,S.SK,W.ix,K.w,X.dQ,k.bd,ee.M,v.x7,L,y,T,x.n_,N.ZU,u.Ck],styles:[".events[_ngcontent-%COMP%]{margin:0;padding:0;list-style:none}.events[_ngcontent-%COMP%]   .ant-badge-status[_ngcontent-%COMP%]{width:100%;overflow:hidden;font-size:12px;white-space:nowrap;text-overflow:ellipsis}.extra[_ngcontent-%COMP%]   nz-badge[_ngcontent-%COMP%]{margin-left:12px}"]}),t})()}];let de=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[F.Bz.forChild(se),F.Bz]}),t})(),ce=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[J.m8,de,v.mS,j,x.Ph,N.ZJ]}),t})()}}]);